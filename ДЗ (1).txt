В базе данных развернута схема SH, используя которую необходимо выполнить задания.
Напомню, что при работе в схеме LEARN (как было на курсах), обращаться к таблицам в схеме SH следует с явным указанием схемы.
Например, select * from sh.countries;

В приложении к письму находится схема таблиц их взаимосвязи, называемая также ER-диаграммой (от Entity-Relationship, Сущности-Связи)

Задание следующее:

Написать запрос, выводящий...

1. Имя и фамилию самых бедных клиентов - среди замужных женщин, не проживающих ни в Японии, ни в Бразилии, ни в Италии. Богатство определяется по кредитному лимиту. [Отсортировать по CUST_LAST_NAME].

2. Клиента с самым длинным домашним адресом, чей телефонный номер заканчивается на 77. Вывести результат в одном столбце, в формате “Name: [cust_first_name] [cust_last_name]; city: [cust_city]; address: [cust_street_address]; number:[cust_main_phone_number]; email: [cust_email]; ”. (всё, что обернуто в [] – названия полей (столбцов) таблицы).

3. Всех клиентов, которые купили самый дешевый продукт в категории ПО (Software/Other) или Фототехника (Photo) (связка таблиц CUSTOMERS -> SALES -> PRODUCTS), среди тех, кто родился позже 1980 года [самостоятельно выбрать категории, которые есть в таблице];

4. Всех клиентов-мужчин с уровнем дохода "D", у которых не заполнено поле "семейное положение" и которые проживают в США или Германии (с использованием EXISTS). Отсортировать по cust_id.

5. Среднюю сумму покупки (является произведением цены товара на количество проданного товара (quantity_sold)) в каждой стране, полное название страны. Отсортировать в порядке убывания средней суммы.

6. "популярность" почтовых доменов клиентов, т.е. количество клиентов с почтой в каждом из доменов.

7. распределение общего количества покупок категории "Мужчины" (Peripherals and Accessories) по странам (т.е. распределение по странам, в которых проживают клиенты), в конечной выборке оставить те страны, в которых общее количество покупок выше, чем средняя сумма покупок в стране (по всему миру) [самостоятельно выбрать категорию, которая есть в таблице]. Упорядочить по полному названию стран.

8. Процентное соотношение мужчин и женщин, проживающих в каждой стране, отсортированное по названию страны в алфавитном порядке. Столбцы в выводе должны быть такими: «Страна», «% мужчин», «% женщин» [использовать WITH]. Упорядочить по полному названию стран.

9. Максимальное суммарное количество проданных единиц товара за день для каждого продукта. Запрос должен выводить TOP 20 строк, отсортированных по убыванию количества покупок (Столбцы должны быть такими: "Макс покуп/день", prod_name) [Под первым столбцом подразумевается объединение в одно поле количества покупок и последней даты, за которую сделаны эти покупки].

10. Максимальное суммарное количество покупок за день для каждой категории продуктов. Отсортировать по убыванию количества. (Столбцы должны быть такими: "Макс за день", prod_category). [Под первым столбцом подразумевается одно число].

11. Создать таблицу с именем sales_[имя пользователя в ОС]_[Ваше имя]_[Ваша фамилия], содержающую строки из таблицы sh.sales за пиковый месяц. (Т.е. месяц, за который получена максимальная выручка). Показать все поля таблицы в порядке возрастания дат.

12. Для созданной в п.11 таблицы изменить значение поля time_id на формат 'DD.MM.YYYY HH24:MI:SS' (см. NLS_DATE_FORMAT). Значение hh24:mm:ss должно выбираться случайным образом. Сохранить сделанные изменения. Показать все поля таблицы в порядке возрастания дат. time_id=time_id+dbms_random.value;

13. Почасовую разбивку количества продаж для Вашей таблицы.

14. Удалить созданную в п. 11 таблицу. Сохранить сделанные изменения.

Примечание: некоторые задания допускают неоднозначное толкование.
Если в задании явно не указаны какие-то нюансы, «додумайте» условие, как вам нравится.
В остальных случаях следует выводить в точности такой ответ, как требуется в задании.
